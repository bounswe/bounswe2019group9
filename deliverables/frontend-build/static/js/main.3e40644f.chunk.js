(window["webpackJsonpbounswe2019-group9-frontend"]=window["webpackJsonpbounswe2019-group9-frontend"]||[]).push([[0],{241:function(e,t,a){},277:function(e,t,a){e.exports=a.p+"static/media/app_icon_transparent.a3964ba4.png"},286:function(e,t,a){e.exports=a(570)},315:function(e,t,a){},515:function(e,t,a){},569:function(e,t,a){},570:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"grades",(function(){return Ee})),a.d(n,"numGradeToGrade",(function(){return Oe})),a.d(n,"numGradeToStrGrade",(function(){return je})),a.d(n,"calculateGrade",(function(){return we}));var r={};a.r(r),a.d(r,"exerciseTypes",(function(){return ke})),a.d(r,"typeIdToType",(function(){return Pe})),a.d(r,"routeToType",(function(){return xe})),a.d(r,"exerciseTypeType",(function(){return Ce})),a.d(r,"exerciseContentType",(function(){return Te}));var o={};a.r(o),a.d(o,"languages",(function(){return qe})),a.d(o,"nameToLanguage",(function(){return Fe})),a.d(o,"idToLanguage",(function(){return Ne})),a.d(o,"languageType",(function(){return Re}));var i={};a.r(i),a.d(i,"appColorDark",(function(){return Be}));var c=a(0),l=a.n(c),s=a(5),u=a.n(s),d=(a(291),a(193),a(292),a(16)),m=a(33),g=a(43),f=a.n(g),p=a(6),h=a(1),b=a.n(h);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var v=new Set,E=localStorage.getItem("bounswe_store");E=E?JSON.parse(E):{token:"",userId:""};b.a.shape({token:b.a.string.isRequired,userId:b.a.oneOfType([b.a.string,b.a.number]).isRequired}).isRequired;var O=function(e){E=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},E,{},e),f.a.defaults.headers.Authorization=E.token,localStorage.setItem("bounswe_store",JSON.stringify(E)),v.forEach((function(e){return e(E)}))},j=function(e){return function(t){var a=l.a.useState(E),n=Object(p.a)(a,2),r=n[0],o=n[1];return l.a.useEffect((function(){function e(e){o(e)}var t;return t=e,v.add(t),function(){!function(e){v.delete(e)}(e)}}),[]),l.a.createElement(e,Object.assign({store:r},t,{updateStore:O}))}};function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var I=!1;if(!I){I=!0,m.a.configure({hideProgressBar:!0,newestOnTop:!0,position:m.a.POSITION.TOP_CENTER,autoClose:3e3});var S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!(e.hasOwnProperty("toastsEnabled")&&!e.toastsEnabled)};f.a.defaults.isToastsEnabled=!0;var k=function(e){var t=null;return console.log("error interceptor",e,e.response),e.response?401===e.response.status||403===e.response.status?(t="Unauthorized, please login again. Your token may have been expired.",O({token:"",userId:""})):t="string"===typeof e.response.data?e.response.data:"Oops something went wrong!":e.request?t="Oops something went wrong in the server!":console.log("Error building axios request",e.message),S(e.config)&&(m.a.done(e.config.uploadToast.id),t&&m.a.error(t)),Promise.reject(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{message:t||e.message}))};f.a.interceptors.request.use((function(e){return function(e){if(S(e)&&(e.uploadToast={id:null},"multipart/form-data"===e.headers["Content-Type"])){var t=e.onUploadProgress;e.onUploadProgress=function(a){var n=a.loaded/(a.total+1);return null===e.uploadToast.id?e.uploadToast.id=m.a.info("Upload in progress",{progress:n,hideProgressBar:!1}):m.a.update(e.uploadToast.id,{progress:n}),t&&t(a)}}return e}(e)})),f.a.interceptors.response.use((function(e){return function(e){if(S(e.config)){m.a.done(e.config.uploadToast.id);var t=e.data,a=t.explanation,n=t.status;if(401===n||403===n)m.a.error("Unauthorized, please login again. Your token may have been expired."),O({token:"",userId:""});else{if(n&&(n<200||n>=300)){var r=a||"Oops something went wrong!";return m.a.error(r),console.log("Custom error on ".concat(e.config.url," ").concat(n," ").concat(a),e.data),Promise.reject({message:r})}var o=null;e.config.hasOwnProperty("successMessage")&&e.config.successMessage?o=e.config.successMessage:a&&(o=a),o&&m.a.success(o)}}return e}(e)}),(function(e){return k(e)}))}a(315);var P=a(22),x=a(24),C=a(25),T=a(20),A=a(26),D=a(17),q=a(74),F=a(578),N=a(591),R=a(580),B=a(586),L=a(53);function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f.a.get("".concat("/api/").concat(e),M({},a,{params:t}))},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f.a.post("".concat("/api/").concat(e),t,M({},a))},H=function(e,t){return W("users/profile",{id:e},t)},G=function(e,t){return _("users/login",e,t)},Y=function(e,t){return _("users/register",e,t)},z=a(572),Q={layout:{height:"100%",alignItems:"center",justifyContent:"center",paddingBottom:"10%"}},V=function(e){var t=e.children;return l.a.createElement(z.a,{style:Q.layout},t)},X=a(96),J=a(4);function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Z={formIcon:{opacity:".25"}},ee=function(e){var t=e.style,a=Object(X.a)(e,["style"]);return l.a.createElement(J.a,Object.assign({},a,{style:t?$({},Z.formIcon,{},t):Z.formIcon}))},te=function(e){function t(){var e,a;Object(P.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!1,error:""},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){e?a.setState({error:e.message}):a.setState({loading:!0},(function(){G(t,{successMessage:"Successfully Logged In"}).then((function(e){var t=((e.data||{}).data||{}).id;O({token:"abc123",userId:t})})).catch((function(e){var t=e.message;a.setState({loading:!1,error:t})}))}))}))},a.handleChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(d.a)({},r,n))},a}return Object(A.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state,a=t.loading,n=t.error;return l.a.createElement(V,null,l.a.createElement(F.a,{title:"Log In",style:ae.loginCard},n&&l.a.createElement(N.a,{type:"error",message:n,showIcon:!0}),l.a.createElement(R.a,{onSubmit:this.handleSubmit,layout:"vertical"},l.a.createElement(R.a.Item,{label:"E-Mail"},e("email",{rules:[{required:!0,message:"Please enter your email."},{type:"email",message:"Please enter valid email"}]})(l.a.createElement(B.a,{placeholder:"Please enter your email.",prefix:l.a.createElement(ee,{type:"mail"})}))),l.a.createElement(R.a.Item,{label:"Password"},e("password",{rules:[{required:!0,message:"Please enter your password."}]})(l.a.createElement(B.a.Password,{placeholder:"Please enter your password.",prefix:l.a.createElement(ee,{type:"lock"})}))),l.a.createElement(R.a.Item,null,l.a.createElement("div",{style:ae.loginLinks},l.a.createElement(D.b,{to:"/forgot"},"Forgot Password")," | ",l.a.createElement(D.b,{to:"/register"},"Create Account")),l.a.createElement(L.a,{style:ae.loginButton,type:"primary",htmlType:"submit",loading:a},a?"Logging in ...":"Log In")))))}}]),t}(l.a.PureComponent),ae={loginCard:{maxWidth:360,width:"80%",minWidth:300},loginLinks:{display:"flex",justifyContent:"space-between",marginBottom:12},loginButton:{width:"100%"}},ne=R.a.create({name:"login_form"})(te),re=function(e){function t(){var e,a;Object(P.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={firstName:"",lastName:"",email:"",password:"",loading:!1,error:"",confirmDirty:!1},a.formItemLayout={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},a.tailFormItemLayout={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){t.confirmPassword;var n=Object(X.a)(t,["confirmPassword"]);e?a.setState({error:e.message}):a.setState({loading:!0},(function(){Y(n,{successMessage:"Successfully Registered"}).then((function(e){var t=((e.data||{}).data||{}).id;O({token:"abc123",userId:t})})).catch((function(e){var t=e.message;a.setState({error:t,loading:!1})}))}))}))},a.handleConfirmBlur=function(e){var t=e.target.value;a.setState((function(e){return{confirmDirty:e.confirmDirty||!!t}}))},a.validatePassword=function(e,t,n){var r=a.props.form;t&&a.state.confirmDirty&&r.validateFields(["confirmPassword"],{force:!0}),n()},a.validateConfirmPassword=function(e,t,n){var r=a.props.form;t&&t!==r.getFieldValue("password")?n("Two passwords you've entered are different!"):n()},a.handleChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(d.a)({},r,n))},a}return Object(A.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state,a=t.loading,n=t.error;return l.a.createElement(V,null,l.a.createElement(F.a,{title:"Register",style:oe.registerCard},n&&l.a.createElement(N.a,{type:"error",message:n,showIcon:!0}),l.a.createElement(R.a,Object.assign({onSubmit:this.handleSubmit},this.formItemLayout),l.a.createElement(R.a.Item,{label:"First Name",hasFeedback:!0},e("firstName",{rules:[{required:!0,message:"Please enter your first name."}]})(l.a.createElement(B.a,{placeholder:"Please enter your first name.",prefix:l.a.createElement(ee,{type:"user"})}))),l.a.createElement(R.a.Item,{label:"Last Name",hasFeedback:!0},e("lastName",{rules:[{required:!0,message:"Please enter your last name."}]})(l.a.createElement(B.a,{placeholder:"Please enter your last name.",prefix:l.a.createElement(ee,{type:"user"})}))),l.a.createElement(R.a.Item,{label:"E-Mail",hasFeedback:!0},e("email",{rules:[{required:!0,message:"Please enter your email."},{type:"email",message:"Please enter valid email"}]})(l.a.createElement(B.a,{type:"email",name:"email",placeholder:"Please enter your email.",prefix:l.a.createElement(ee,{type:"mail"})}))),l.a.createElement(R.a.Item,{label:"Password",hasFeedback:!0},e("password",{rules:[{required:!0,message:"Please enter your password."},{validator:this.validatePassword}]})(l.a.createElement(B.a.Password,{placeholder:"Please enter your password.",prefix:l.a.createElement(ee,{type:"lock"})}))),l.a.createElement(R.a.Item,{label:"Confirm Password",hasFeedback:!0},e("confirmPassword",{rules:[{required:!0,message:"Please confirm your password."},{validator:this.validateConfirmPassword}]})(l.a.createElement(B.a.Password,{placeholder:"Please confirm your password.",prefix:l.a.createElement(ee,{type:"lock"}),onBlur:this.handleConfirmBlur}))),l.a.createElement(R.a.Item,this.tailFormItemLayout,l.a.createElement("div",{style:oe.registerLinks},l.a.createElement(D.b,{to:"/login"},"Login Instead")),l.a.createElement(L.a,{style:oe.registerButton,type:"primary",htmlType:"submit",loading:a},a?"Registering...":"Register")))))}}]),t}(l.a.PureComponent),oe={registerCard:{maxWidth:500,width:"90%",minWidth:300},registerLinks:{display:"flex",justifyContent:"flex-end"},registerButton:{width:"100%"}},ie=R.a.create({name:"register_form"})(re),ce=function(e){function t(){var e,a;Object(P.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!1,error:"",success:!1},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields((function(e,t){e?a.setState({error:e.message}):a.setState({loading:!0},(function(){setTimeout((function(){Math.random()<.5?a.setState({loading:!1,error:"There is an error, please try again."}):a.setState({loading:!1,success:!0})}),2e3*Math.random())}))}))},a.handleChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(d.a)({},r,n))},a}return Object(A.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.state,t=e.loading,a=e.error,n=e.success,r=this.props.form.getFieldDecorator;return l.a.createElement(V,null,l.a.createElement(F.a,{title:"Forgot My Password",style:le.forgotCard},n?l.a.createElement("p",null,"Please check your email."):l.a.createElement(l.a.Fragment,null,a&&l.a.createElement(N.a,{type:"error",message:a,showIcon:!0}),l.a.createElement(R.a,{onSubmit:this.handleSubmit,layout:"vertical"},l.a.createElement(R.a.Item,{label:"E-Mail"},r("email",{rules:[{required:!0,message:"Please enter your email."},{type:"email",message:"Please enter valid email"}]})(l.a.createElement(B.a,{placeholder:"Please enter your email.",prefix:l.a.createElement(ee,{type:"mail"})}))),l.a.createElement(R.a.Item,null,l.a.createElement("div",{style:le.forgotLinks},l.a.createElement(D.b,{to:"/login"},"Login Instead")," | ",l.a.createElement(D.b,{to:"/register"},"Create Account")),l.a.createElement(L.a,{style:le.forgotButton,type:"primary",htmlType:"submit",loading:t},t?"Sending ...":"Send"))))))}}]),t}(l.a.PureComponent),le={forgotCard:{maxWidth:360,width:"80%",minWidth:300},forgotLinks:{display:"flex",justifyContent:"space-between",marginBottom:12},forgotButton:{width:"100%"}},se=R.a.create({name:"forgot_password"})(ce),ue=function(e){function t(){return Object(P.a)(this,t),Object(C.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return l.a.createElement(q.d,null,l.a.createElement(q.b,{exact:!0,path:"/login",component:ne}),l.a.createElement(q.b,{exact:!0,path:"/register",component:ie}),l.a.createElement(q.b,{exact:!0,path:"/forgot",component:se}),l.a.createElement(q.a,{to:"/login"}))}}]),t}(l.a.PureComponent),de=a(588),me=function(e,t){return _("search/exercises",e,t)},ge=function(e){function t(){var e,a;Object(P.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={languages:[],loading:!0},a.handleChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(d.a)({},r,n))},a}return Object(A.a)(t,e),Object(x.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;W("contents/languages",{},e).then((function(e){var a=(e.data||{}).data,n=void 0===a?[]:a;t.setState({languages:n,loading:!1})})).catch(console.error)}},{key:"render",value:function(){var e=this.state,t=e.languages,a=e.loading;return l.a.createElement(V,null,l.a.createElement(F.a,{title:"Select a Language",style:fe.card},l.a.createElement(de.a,{loading:a,title:!1},l.a.createElement("ul",null,t.map((function(e){return l.a.createElement("li",{key:e},l.a.createElement(D.b,{to:"/".concat(e,"/")},e))}))))))}}]),t}(l.a.PureComponent),fe={card:{marginBottom:120,width:300}},pe=ge,he=a(283),be=function(e,t){return _("grades/add",e,t)},ye=function(e,t){return W("grades/get",e,t)};function ve(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Ee=[{num_grade:1,str_grade:"A1 - Beginner"},{num_grade:2,str_grade:"A2 - Elementary"},{num_grade:3,str_grade:"B1 - Intermediate"},{num_grade:4,str_grade:"B2 - Upper Intermediate"},{num_grade:5,str_grade:"C1 - Advanced"},{num_grade:6,str_grade:"C2 - Proficient"}],Oe=function(){var e=Ee.reduce((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ve(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ve(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,Object(d.a)({},t.num_grade,t))}),{});return function(t){return e[t]||{num_grade:0,str_grade:"Unknown Grade"}}}(),je=function(e){return Oe(e).str_grade},we=function(e,t){var a=0,n="Unknown Grade",r=-1;return t<=0||e<0||e>t?{num_grade:r,str_grade:n}:((a=e/t)>.9?(r=6,n="C2"):a>.85?(r=5,n="C1"):a>.75?(r=4,n="B2"):a>.6?(r=3,n="B1"):a>.4?(r=2,n="A2"):(r=1,n="A1"),{num_grade:r,str_grade:n})};function Ie(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ie(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ie(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ke=[{typeId:1,route:"listening",name:"Listening",icon:"customer-service"},{typeId:2,route:"reading",name:"Reading",icon:"read"},{typeId:4,route:"grammar",name:"Grammar",icon:"file-text"},{typeId:3,route:"vocabulary",name:"Vocabulary",icon:"book"}],Pe=function(){var e=ke.reduce((function(e,t){return Se({},e,Object(d.a)({},t.typeId,t))}),{});return function(t){return e[t]||{typeId:0,route:"",name:"Unknown"}}}(),xe=function(){var e=ke.reduce((function(e,t){return Se({},e,Object(d.a)({},t.route,t))}),{});return function(t){return e[t]||{typeId:0,route:"",name:"Unknown"}}}(),Ce=b.a.shape({typeId:b.a.number.isRequired,route:b.a.string.isRequired,name:b.a.string.isRequired}),Te=b.a.shape({id:b.a.number.isRequired,languageId:b.a.number.isRequired,grade:b.a.number.isRequired,typeId:b.a.number.isRequired,imageUrl:b.a.string,soundUrl:b.a.string,questionBody:b.a.string.isRequired,optionA:b.a.string.isRequired,optionB:b.a.string.isRequired,optionC:b.a.string.isRequired,optionD:b.a.string.isRequired,correctAnswer:b.a.number.isRequired,tags:b.a.arrayOf(b.a.shape({id:b.a.number.isRequired,exerciseId:b.a.number.isRequired,tagText:b.a.string.isRequired})).isRequired});function Ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function De(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ae(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ae(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var qe=[{languageId:1,name:"English"},{languageId:2,name:"Turkish"},{languageId:3,name:"Italian"}],Fe=function(){var e=qe.reduce((function(e,t){return De({},e,Object(d.a)({},t.name,t))}),{});return function(t){return e[t]||{languageId:0,name:"Unknown Language"}}}(),Ne=function(){var e=qe.reduce((function(e,t){return De({},e,Object(d.a)({},t.languageId,t))}),{});return function(t){return e[t]||{languageId:0,name:"Unknown Language"}}}(),Re=b.a.shape({languageId:b.a.number.isRequired,name:b.a.string.isRequired}),Be="#0c360b",Le=a(590),Ue=a(589),Me=a(191),We=[{route:"main",name:"Main",icon:"project"},{route:"proficiency-exam",name:"Proficiency Exam",icon:"diff"}],_e={header:{margin:"24px 12px"}},He=j((function(e){var t=e.store,a=Object(q.i)().language,i=Object(q.h)().pathname,s=o.nameToLanguage(a).languageId,u=Object(c.useState)(),d=Object(p.a)(u,2),m=d[0],g=d[1],f=i.split("/").slice(2).filter((function(e){return e})).join("/")||"main";Object(c.useEffect)((function(){s&&ye({userId:t.userId,languageId:s}).then((function(e){var t=(e.data||{}).data;g(((void 0===t?{}:t)||{}).grade||null)})).catch(console.log)}),[a]);var h=n.numGradeToStrGrade(m);return l.a.createElement("div",null,l.a.createElement("div",{style:_e.header},l.a.createElement(de.a,{loading:void 0===m,title:!1},l.a.createElement(Le.a,{title:a},l.a.createElement(Le.a.Item,{label:"Grade"},l.a.createElement(Ue.a,{color:"#87d068"},null===m?"Not Graded Yet":h))))),l.a.createElement(Me.a,{selectedKeys:[f],mode:"inline"},We.map((function(e){var t=e.name,n=e.route,r=e.icon;return l.a.createElement(Me.a.Item,{key:n},l.a.createElement(J.a,{type:r}),t,l.a.createElement(D.b,{to:"/".concat(a,"/").concat(n)}))})),l.a.createElement(Me.a.SubMenu,{key:"exercises",title:l.a.createElement("span",null,l.a.createElement(J.a,{type:"reconciliation"}),l.a.createElement("span",null,"Exercises"))},l.a.createElement(Me.a.Item,{key:"exercises/search"},l.a.createElement(J.a,{type:"file-search"}),"Search",l.a.createElement(D.b,{to:"/".concat(a,"/exercises/search")})),r.exerciseTypes.map((function(e){e.typeId;var t=e.route,n=e.name,r=e.icon;return l.a.createElement(Me.a.Item,{key:"exercises/".concat(t)},l.a.createElement(J.a,{type:r}),n,l.a.createElement(D.b,{to:"/".concat(a,"/exercises/").concat(t)}))}))),l.a.createElement(Me.a.Item,{key:"writing"},l.a.createElement(J.a,{type:"form"}),"Writing",l.a.createElement(D.b,{to:"/".concat(a,"/writing")})),l.a.createElement(Me.a.Item,{key:"suggest"},l.a.createElement(J.a,{type:"question"}),"Suggest Exercise",l.a.createElement(D.b,{to:"/".concat(a,"/suggest")}))))})),Ge=a(95),Ye=a(573),ze=a(584);function Qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Ve=j(function(e){function t(){var e,a;Object(P.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(i)))).state={questions:[],answers:[],currentQuestion:0,currentGrade:0,lastAnswered:-1,loading:!0},a.answerQuestion=function(e){var t=a.state,n=t.currentQuestion,r=t.currentGrade,o=t.lastAnswered,i=t.questions[n]||{},c=Object(Ge.a)(a.state.answers);c[n]=e+1;var l=i.correctAnswer;a.setState({answers:c,lastAnswered:o+1,currentGrade:r+(e===l?1:0)})},a.nextQuestion=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=a.props.store,r=a.props.match.params.language,i=o.nameToLanguage(r),c=a.state,l=c.currentQuestion,s=c.questions,u=c.answers;c.currentGrade;if(l+e===s.length){var d=s.reduce((function(e,t,a){var n=t.correctAnswer;return e+((u[a]||0)===n?0:1)}),0),g=n.calculateGrade(d,s.length),f=g.num_grade,p=g.str_grade;be({userId:t.userId,languageId:i.languageId,grade:f}).then((function(e){m.a.info("Congrats, you got ".concat(d," correct answers out of ").concat(s.length," questions.\nYour grade is ").concat(p));var t=a.props,n=t.match.params.language;t.history.push("/".concat(n)),console.log(e)})).catch(console.error)}else a.setState({currentQuestion:Math.max(0,Math.min(s.length-1,l+e))})},a}return Object(A.a)(t,e),Object(x.a)(t,[{key:"componentDidMount",value:function(){var e,t,a=this,n=this.props.match.params.language;(e=n,W("contents/prof",{language:e},t)).then((function(e){var t=e.data.data;t&&a.setState({questions:t.map((function(e){var t=e.optionA,a=e.optionB,n=e.optionC,r=e.optionD,o=e.correctAnswer;return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qe(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(X.a)(e,["optionA","optionB","optionC","optionD","correctAnswer"]),{options:[t,a,n,r],correctAnswer:o-1})})),loading:!1})})).catch(console.error)}},{key:"render",value:function(){var e=this,t=this.state,a=t.questions,n=t.answers,r=t.currentQuestion,o=(t.currentGrade,t.lastAnswered),i=t.loading,c=a[r]||{},s=n[r],u=c.questionBody,d=void 0===u?"":u,m=c.options,g=void 0===m?[]:m;c.correctAnswer;return l.a.createElement("div",null,l.a.createElement(Ye.a,{title:"Proficiency Exam",subTitle:i?"Loading ...":"".concat(r+1," / ").concat(a.length)}),l.a.createElement(F.a,{title:l.a.createElement(de.a,{loading:i,paragraph:!1},d),actions:[l.a.createElement(L.a,{color:"dashed",onClick:function(){return e.nextQuestion(-1)},disabled:0===r},l.a.createElement(J.a,{type:"left"}),"Previous Question"),l.a.createElement(L.a,{color:"primary",onClick:function(){return e.nextQuestion()},disabled:o<r},l.a.createElement(J.a,{type:"right"}),r+1===a.length?"Finish Exam":"Next Question")]},l.a.createElement(de.a,{loading:i,paragraph:!1},l.a.createElement(ze.a.Group,{value:s},g.map((function(t,a){return l.a.createElement(ze.a.Button,{key:"Option_".concat(a),value:a+1,onClick:function(){return e.answerQuestion(a)}},t)}))))))}}]),t}(l.a.PureComponent)),Xe=a(56),Je=a(100),Ke=function(e,t){return _("suggestion/add",e,t)},$e=function(e){function t(){var e,a;Object(P.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={expand:!1},a.handleSubmit=function(e){e.preventDefault();var t={question:e.target.question.value,choice1:e.target.choice1.value,choice2:e.target.choice2.value,choice3:e.target.choice3.value,choice4:e.target.choice4.value};Ke(t),console.log(t)},a}return Object(A.a)(t,e),Object(x.a)(t,[{key:"getFields",value:function(){for(var e=this.state.expand?10:6,t=(this.props.form.getFieldDecorator,[]),a=0;a<4;a++)t.push(l.a.createElement(Xe.a,{span:6,key:a,style:{display:a<e?"block":"none"}},l.a.createElement(R.a.Item,null,l.a.createElement(B.a,{name:"choice".concat(a+1),addonBefore:"Choice ".concat(a+1),placeholder:"Choices"}))));return t}},{key:"render",value:function(){return l.a.createElement(R.a,{className:"suggest-form",onSubmit:this.handleSubmit},l.a.createElement(Je.a,{gutter:24},l.a.createElement(R.a.Item,null,l.a.createElement(B.a,{name:"question",addonBefore:"Question",placeholder:"Write Your question here"}))),l.a.createElement(Je.a,{gutter:24},this.getFields()),l.a.createElement(Je.a,null,l.a.createElement(Xe.a,{span:12,style:{textAlign:"right"}},l.a.createElement(L.a,{type:"primary",htmlType:"submit"},"Suggest Exercise"))))}}]),t}(l.a.Component),Ze=R.a.create({name:"suggest"})($e),et=a(587),tt=a(577),at=a(118),nt=a(574),rt=function(e,t){return _("essays",e,t)},ot=function(e,t){return _("files/images/essay",e,t)};function it(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||et.a.error("You can only upload JPG/PNG file!");var a=e.size/1024/1024<2;return a||et.a.error("Image must smaller than 2MB!"),t&&a}var ct=function(e){function t(e){var a;Object(P.a)(this,t),(a=Object(C.a)(this,Object(T.a)(t).call(this,e))).submit=function(e){e.preventDefault();var t=a.state,n=t.photo,r=t.photoUrl;a.props.form.validateFields((function(e,t){e?a.setState({error:e.message}):rt({authorId:a.userId,assignmentId:t.assignmentId,sourceType:n?2:1,source:n?r:t.body}).then((function(){m.a.success("You have successfully submitted essay"),a.props.history.push("/essays")}))}))},a.handleUploadChange=function(e){"uploading"!==e.file.status?"done"===e.file.status&&function(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}(e.file.originFileObj,(function(e){a.setState({imageUrl:e,loading:!1}),ot({authorId:a.userId,base64Data:e,exerciseId:a.state.chosenAssignment}).then((function(e){var t=(e.data||{}).data;a.setState({photoUrl:t})})).catch(console.log)})):a.setState({loading:!0})},a.renderUpload=function(){var e=l.a.createElement("div",null,l.a.createElement(J.a,{type:a.state.loading?"loading":"plus"}),l.a.createElement("div",{className:"ant-upload-text"},"Upload")),t=a.state.imageUrl;return l.a.createElement(tt.a,{name:"avatar",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",beforeUpload:it,onChange:a.handleUploadChange},t?l.a.createElement("img",{src:t,alt:"avatar",style:{width:"100%"}}):e)};var n=e.match.params.language;return a.userId=a.props.store.userId,a.languageId=Fe(n).languageId,a.state={subject:"",text:"",submitted:!1,photo:!1,loading:!1,chosenAssignment:null,assignments:[]},a}return Object(A.a)(t,e),Object(x.a)(t,[{key:"componentDidMount",value:function(){var e,t,a=this;(e=this.languageId,W("assignments/language",{id:e},t)).then((function(e){var t=(e.data||{}).data,n=void 0===t?[]:t;a.setState({assignments:n})}))}},{key:"onChange",value:function(e){this.setState(Object(d.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=this,t=this.props.form,a=this.state,n=a.photo,r=(a.subject,a.text,a.submitted),o=a.assignments;return r?l.a.createElement("div",null,l.a.createElement(Ye.a,{title:"Writing Exercise"}),l.a.createElement("span",null,"You have successfully submitted your writing exercise!")):l.a.createElement("div",{style:{overflow:"auto",height:"100%"}},l.a.createElement(Ye.a,{title:"Writing Exercise"}),l.a.createElement(R.a,{layout:"vertical",onSubmit:this.submit},l.a.createElement(R.a.Item,{label:"Subject"},t.getFieldDecorator("assignmentId",{rules:[{required:!0,message:"Please select a assignmentId"}]})(l.a.createElement(at.a,{placeholder:"Please choose a subject from here",onChange:function(t){return e.setState({chosenAssignment:t})}},o.map((function(e){var t=e.id,a=e.question;return l.a.createElement(at.a.Option,{key:t,value:t},a)}))))),"Text ",l.a.createElement(nt.a,{onChange:function(t){return e.setState({photo:t})}})," Photo",l.a.createElement("br",null)," ",l.a.createElement("br",null),n?this.renderUpload():l.a.createElement(R.a.Item,{label:"Essay"},t.getFieldDecorator("body",{rules:[{required:!0,message:"Please write your essay"}]})(l.a.createElement(B.a.TextArea,{rows:30,placeholder:"Write your essay here"}))),l.a.createElement(R.a.Item,null,l.a.createElement(L.a,{htmlType:"submit",type:"primary"},"Submit"))))}}]),t}(l.a.Component),lt=j(Object(q.j)(R.a.create({name:"writing_form"})(ct))),st=j((function(e){var t=e.store,a=Object(q.i)().language,r="English"===a?1:"Turkish"===a?2:"Italian"===a?3:0,o=Object(c.useState)(!1),i=Object(p.a)(o,2),s=i[0],u=i[1],d=Object(c.useState)(),m=Object(p.a)(d,2),g=m[0],f=m[1];if(Object(c.useEffect)((function(){r&&(u(!0),ye({userId:t.userId,languageId:r}).then((function(e){var t=(e.data||{}).data;f(((void 0===t?{}:t)||{}).grade||0),u(!1)})))}),[a,r,t.userId]),0===r)return l.a.createElement("div",null,"Unknown Language");var h=n.numGradeToStrGrade(g);return l.a.createElement("div",null,l.a.createElement("h3",null,a),s?l.a.createElement("h4",null,"Loading your grade ..."):l.a.createElement(l.a.Fragment,null,l.a.createElement("h4",null," ",g?"Your grade is ".concat(h):"You don't have a grade in this language"," "),l.a.createElement(D.b,{to:"/".concat(a,"/proficiency-exam")},g?"Click here to re-take proficiency exam":"Click here to take proficiency exam")))}));r.propTypes={title:b.a.string,loading:b.a.bool,language:o.languageType.isRequired,exerciseType:r.exerciseTypeType,exercises:b.a.arrayOf(r.exerciseContentType).isRequired},r.defaultProps={title:"Exercises",loading:!1,exerciseType:null};var ut={correctAnswer:{backgroundColor:"#efe"},incorrectAnswer:{backgroundColor:"#fee"},tags:{marginBottom:16},sound:{margin:"12px 0"}},dt=function(e){var t=e.title,a=e.loading,n=e.language,r=(e.exerciseType,e.exercises),o=Object(c.useState)(0),i=Object(p.a)(o,2),s=i[0],u=i[1],d=Object(c.useState)([]),g=Object(p.a)(d,2),f=g[0],h=g[1],b=Object(q.g)(),y=r[s]||{},v=f[s],E=y.questionBody,O=y.tags,j=void 0===O?[]:O,w=y.imageUrl,I=y.soundUrl,S=[y.optionA,y.optionB,y.optionC,y.optionD],k=Object(c.createRef)(),P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(s+e===r.length){var a=r.reduce((function(e,t,a){var n=t.correctAnswer;return e+(f[a]===n?1:0)}),0),o=r.reduce((function(e,t,a){var n=t.correctAnswer;return e+(f[a]&&f[a]!==n?1:0)}),0);m.a.info("You finished the ".concat(t.toLowerCase()," with ").concat(a," correct answers, ").concat(o," incorrect answers and ").concat(r.length-a-o," skipped!")),b.push("/".concat(n.name))}else u(s+e)};Object(c.useEffect)((function(){k.current&&(k.current.pause(),setTimeout((function(){k.current&&k.current.load()}),100))}),[I]);return l.a.createElement("div",null,l.a.createElement(Ye.a,{title:t,subTitle:a?"Loading ...":"".concat(s+1," / ").concat(r.length)}),j.length?l.a.createElement("div",{style:ut.tags},l.a.createElement(J.a,{type:"tags"}),"  ",j.map((function(e){var t=e.id,a=e.tagText;return l.a.createElement(Ue.a,{key:t},a)}))):null,l.a.createElement(F.a,{loading:a,title:l.a.createElement(de.a,{loading:a,paragraph:!1},E),actions:[l.a.createElement(L.a,{color:"dashed",onClick:function(){return P(-1)},disabled:0===s},l.a.createElement(J.a,{type:"left"}),"Previous Question"),l.a.createElement(L.a,{color:"primary",onClick:function(){return P(1)}},l.a.createElement(J.a,{type:"right"}),s+1===r.length?"Finish Exercises":"Next Question")]},w&&l.a.createElement("div",null,l.a.createElement("img",{src:w,alt:"".concat(t," ").concat(s+1),"data-testid":"image"})),I&&l.a.createElement("div",{style:ut.sound},l.a.createElement("audio",{controls:!0,ref:k,"data-testid":"audio"},l.a.createElement("source",{src:I,"data-testid":"audio-source"}))),l.a.createElement(ze.a.Group,{value:v},S.map((function(e,t){return l.a.createElement(ze.a.Button,{key:"Option_".concat(t),value:t+1,onClick:function(){return function(e){if(v)m.a.error("You can't change your choice!");else{var t=Object(Ge.a)(f);t[s]=e+1,h(t)}}(t)},style:v&&(t+1===y.correctAnswer?ut.correctAnswer:ut.incorrectAnswer)},e)})))))},mt=j((function(e){e.store.userId;var t=Object(q.i)(),a=t.language,n=t.exerciseType,i=r.routeToType(n),s=o.nameToLanguage(a),u=Object(c.useState)([]),d=Object(p.a)(u,2),m=d[0],g=d[1],f=Object(c.useState)(!1),h=Object(p.a)(f,2),b=h[0],y=h[1];return Object(c.useEffect)((function(){y(!0),me({languageId:s.languageId,typeId:i.typeId}).then((function(e){var t=(e.data||{}).data,a=void 0===t?[]:t;a.sort((function(e,t){return e.grade-t.grade})),g(a),y(!1)}))}),[a,n]),l.a.createElement(dt,{title:"".concat(i.name," Exercises"),loading:b,language:s,exerciseType:i,exercises:m})})),gt=a(582),ft=at.a.Option,pt=R.a.create({name:"inline_login"})((function(e){var t=e.onSubmit,a=e.form,i=a.getFieldDecorator;a.getFieldsError,a.getFieldError,a.isFieldTouched;return l.a.createElement(R.a,{layout:"inline",onSubmit:function(e){e.preventDefault(),a.validateFields((function(e,a){e||t(a)}))}},l.a.createElement(R.a.Item,null,i("tag",{initialValue:""})(l.a.createElement(B.a,{placeholder:"Any",label:"Tag"}))),l.a.createElement(R.a.Item,null,i("grade",{initialValue:0})(l.a.createElement(at.a,{title:"Grade",style:{width:120}},l.a.createElement(ft,{value:0},"All Grades"),n.grades.map((function(e){var t=e.num_grade,a=e.str_grade;return l.a.createElement(ft,{value:t},a)}))))),l.a.createElement(R.a.Item,null,i("typeId",{initialValue:0})(l.a.createElement(at.a,{title:"Type",style:{width:120}},l.a.createElement(ft,{value:0},"All Types"),r.exerciseTypes.map((function(e){var t=e.typeId,a=e.name;return l.a.createElement(ft,{value:t},a)}))))),l.a.createElement(R.a.Item,null,i("languageId",{initialValue:""})(l.a.createElement(at.a,{label:"Language",style:{width:160}},l.a.createElement(ft,{value:""},"All Languages"),o.languages.map((function(e){var t=e.languageId,a=e.name;return l.a.createElement(ft,{value:t},a)}))))),l.a.createElement(L.a,{type:"primary",htmlType:"submit"},"Search"))})),ht={card:{padding:20,height:"100%"},innerCard:{overflow:"auto",maxHeight:"100%"},correctAnswer:{backgroundColor:"#efe"},incorrectAnswer:{backgroundColor:"#fee"}},bt=function(){var e=Object(c.useState)([]),t=Object(p.a)(e,2),a=t[0],i=t[1];return l.a.createElement("div",{style:ht.card},l.a.createElement("div",{style:ht.innerCard},l.a.createElement(pt,{onSubmit:function(e){me(e).then((function(e){var t=(e.data||[]).data;i(void 0===t?[]:t)})).catch(console.log)}}),a.length>0&&l.a.createElement(gt.a,{accordion:!0},a.map((function(e){var t=e.id,a=e.tags,i=e.typeId,c=e.languageId,s=e.questionBody,u=e.imageUrl,d=e.grade,m=e.optionA,g=e.optionB,f=e.optionC,p=e.optionD,h=e.correctAnswer;return l.a.createElement(gt.a.Panel,{key:t,header:l.a.createElement(Le.a,{column:4},l.a.createElement(Le.a.Item,{label:"Type"},r.typeIdToType(i).name),l.a.createElement(Le.a.Item,{label:"Language"},o.idToLanguage(c).name),l.a.createElement(Le.a.Item,{label:"Grade"},n.numGradeToStrGrade(d)),l.a.createElement(Le.a.Item,{label:l.a.createElement("span",null,l.a.createElement(J.a,{type:"tags"}))},a.map((function(e){var t=e.id,a=e.tagText;return l.a.createElement(Ue.a,{key:t},a)})),0===a.length&&"No tags."))},u&&l.a.createElement("img",{src:u,alt:u}),l.a.createElement("div",null,l.a.createElement("h3",null,s)),l.a.createElement("div",null,l.a.createElement(ze.a.Group,null,[m,g,f,p].map((function(e,t){return l.a.createElement(ze.a.Button,{key:"Option_".concat(t),value:t+1,style:t+1===h?ht.correctAnswer:ht.incorrectAnswer},e)})))))})))))};function yt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function vt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?yt(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Et=vt({"proficiency-exam":"Proficiency Exam",exercises:"Exercises"},r.exerciseTypes.reduce((function(e,t){var a=t.route,n=t.name;return vt(Object(d.a)({},a,n),e)}),{}),{search:"Search"}),Ot={container:{height:"100%"},layout:{height:"100%",padding:"0 24px 24px"},content:{background:"#fff",padding:24,margin:0},breadcrumb:{margin:"16px 0"}},jt=function(){var e=Object(q.i)().language,t=Object(q.h)().pathname.split("/").filter((function(e){return e}));return l.a.createElement(z.a,{style:Ot.container},l.a.createElement(z.a.Sider,{theme:"light",width:200,collapsible:!0},l.a.createElement(He,null)),l.a.createElement(z.a,{style:Ot.layout},l.a.createElement(he.a,{style:Ot.breadcrumb},t.map((function(e,a){return l.a.createElement(he.a.Item,{key:e},l.a.createElement(D.c,{to:"/".concat(t.slice(0,a+1).join("/"))},Et[e]||e))}))),l.a.createElement(z.a.Content,{style:Ot.content},l.a.createElement(q.d,null,l.a.createElement(q.b,{exact:!0,path:"/:language",component:st}),l.a.createElement(q.b,{exact:!0,path:"/:language/exercises/search",component:bt}),l.a.createElement(q.b,{path:"/:language/suggest",component:Ze}),l.a.createElement(q.b,{path:"/:language/writing",component:lt}),l.a.createElement(q.b,{exact:!0,path:"/:language/exercises/:exerciseType",component:mt}),l.a.createElement(q.b,{path:"/:language/proficiency-exam",component:Ve}),l.a.createElement(q.a,{to:"/".concat(e)})))))},wt=a(581),It=function(e){function t(){return Object(P.a)(this,t),Object(C.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return l.a.createElement(V,null,l.a.createElement(F.a,null,l.a.createElement(wt.a.Title,{level:1},"Welcome to Kereviz !"),l.a.createElement(D.b,{to:"/language-select"},"Please select a language to continue")))}}]),t}(l.a.PureComponent),St=a(277),kt=a.n(St),Pt=function(){O({token:"",userId:""})},xt=[{name:"Home",route:"/home"},{name:"Sample Page",route:"/sample"},{name:"Select Language",route:"/language-select"},{name:"User Search",route:"/users"},{name:"Chat",route:"/chat"},{name:"My Essays",route:"/essays"},{name:"Essay Reviews",route:"/reviews"}],Ct={logo:{height:"100%",float:"left",margin:"0 24px 0 -8px",display:"flex",alignItems:"center"},logoTitle:{color:"#fff",margin:"0 0 0 4px"},logoImage:{height:36},menu:{lineHeight:"64px",backgroundColor:i.appColorDark},profileSubmenu:{float:"right"}},Tt=j((function(e){var t=e.store.userId,a=Object(q.h)().pathname,n=Object(c.useState)(),r=Object(p.a)(n,2),o=r[0],i=r[1];Object(c.useEffect)((function(){t&&function(e,t){return W("users/get",{id:e},t)}(t).then((function(e){var t=(e.data||{}).data;i(void 0===t?{}:t)})).catch(console.log)}),[t]);var s=o||{},u=s.firstName,d=s.lastName;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:Ct.logo},l.a.createElement("img",{src:kt.a,alt:"kereviz-logo",style:Ct.logoImage}),l.a.createElement(wt.a.Title,{level:3,style:Ct.logoTitle},"Kereviz")),l.a.createElement(Me.a,{theme:"dark",mode:"horizontal",style:Ct.menu,selectedKeys:[a]},xt.map((function(e){var t=e.name,a=e.route;return l.a.createElement(Me.a.Item,{key:a},t,l.a.createElement(D.b,{to:a}))})),l.a.createElement(Me.a.SubMenu,{style:Ct.profileSubmenu,title:l.a.createElement("span",{className:"submenu-title-wrapper"},l.a.createElement(J.a,{type:"user"}),u," ",d)},l.a.createElement(Me.a.Item,{key:"/users/".concat(t)},"Profile",l.a.createElement(D.b,{to:"/users/".concat(t)})),l.a.createElement(Me.a.Item,{onClick:Pt},"Log Out"))))})),At=a(120),Dt=a.n(At),qt=a(189),Ft=function(e,t){return W("greeting",e,t)},Nt=function(e){function t(){var e,a;Object(P.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(C.a)(this,(e=Object(T.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",greeting:"",loading:!1},a.handleChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(d.a)({},r,n))},a.handleSubmit=function(){var e=Object(qt.a)(Dt.a.mark((function e(t){return Dt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a.props.form.validateFields((function(e,t){e?a.setState({error:e.message}):a.setState({loading:!0},Object(qt.a)(Dt.a.mark((function e(){var n,r,o;return Dt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ft(t);case 3:n=e.sent,r=n.data||{},o=r.content,a.setState({greeting:o,loading:!1}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(A.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.state,t=e.loading,a=e.greeting,n=this.props.form.getFieldDecorator;return l.a.createElement(V,null,l.a.createElement(F.a,null,l.a.createElement("h1",null,"Welcome!"),l.a.createElement("p",null,"This is a simple endpoint tester, which we can use to test the api in a simple way."),l.a.createElement("hr",null),l.a.createElement("p",null,"You can type your name in order for server to greet you :)"),l.a.createElement(R.a,{onSubmit:this.handleSubmit,layout:"inline"},l.a.createElement(R.a.Item,{label:"Your name:"},n("name",{rules:[{required:!0,message:"Please enter a name."}]})(l.a.createElement(B.a,{placeholder:"Egemen"}))),l.a.createElement(R.a.Item,null,l.a.createElement(L.a,{type:"primary",htmlType:"submit",loading:t},"Greet"))),a?l.a.createElement("div",null,l.a.createElement("hr",null),l.a.createElement("p",null,a)):null))}}]),t}(l.a.PureComponent),Rt=R.a.create({name:"sample_form"})(Nt),Bt=(a(515),a(272)),Lt=a(585),Ut=function(e){var t=e.sourceId,a=e.receiverId,n="Send Invite",r="Loading",o="Pending",i="Accept?",s="Connected",u=Object(c.useState)(!1),d=Object(p.a)(u,2),m=d[0],g=d[1],f=Object(c.useState)(!0),h=Object(p.a)(f,2),b=h[0],y=h[1],v=Object(c.useState)(r),E=Object(p.a)(v,2),O=E[0],j=E[1];Object(c.useEffect)((function(){var e,r;(e={userId1:t,userId2:a},W("invitations/state",e,r)).then((function(e){var r=(e.data||{}).data,c=void 0===r?{}:r;c.userId1===t&&c.userId2===a?(c.pendingRequestFromTwoToOne&&c.pendingRequestFromOneToTwo?console.error("Concurrent pendings."):c.startedConversation?(j(s),g(!0)):c.pendingRequestFromTwoToOne?(j(i),g(!1)):c.pendingRequestFromOneToTwo?(j(o),g(!0)):(j(n),g(!1)),y(!1)):console.error("Peers do not match.")})).catch(console.error)}),[t]);return l.a.createElement(L.a,{onClick:function(e){var c,l;e.preventDefault(),m||b||(y(!0),j(r),O===n?(c={sourceId:t,receiverId:a},_("invitations/add",c,l)).then((function(e){(e.data||{}).data;g(!0),y(!1),j(o)})).catch(console.log):O===i&&function(e,t){return _("invitations/answer",e,t)}({sourceId:t,receiverId:a,approved:!0}).then((function(e){(e.data||{}).data;g(!0),y(!1),j(s)})))},type:"primary",loading:b,disabled:m},O)},Mt=function(e){return new Promise((function(t,a){return setTimeout((function(){t()}),e)}))},Wt=function(e,t){return"https://api.adorable.io/avatars/".concat(t,"/").concat(e)},_t=function(e){var t=e.store,a=e.firstName,n=e.grades,r=e.userId,o=e.languages,i=e.lastName,s=e.progressLevels,u=e.isButtonPresent,d=void 0!==u&&u,m=Object(c.useState)(0),g=Object(p.a)(m,2),f=g[0],h=g[1];Object(c.useEffect)((function(){Mt(1200).then((function(e){var t=Math.round(7.4)/2;h(t)}))}),[r]);var b=o.map((function(e,t){return[e,n[t],s[t]]}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(Le.a,{title:"User Info",column:d?4:void 0},l.a.createElement(Le.a.Item,null,l.a.createElement(Bt.a,{src:Wt(r,60),alt:"Avatar",size:60})),l.a.createElement(Le.a.Item,{label:"Full Name",className:"capitalize-text"},[a,i].join(" ")),l.a.createElement(Le.a.Item,{label:"Rating"},l.a.createElement(Lt.a,{allowHalf:!0,disabled:!0,value:f})),t.userId!==r?l.a.createElement(Le.a.Item,null,l.a.createElement(D.b,{to:"/users/".concat(r)},l.a.createElement(Ut,{sourceId:t.userId,receiverId:r}))):null,d?l.a.createElement(Le.a.Item,null,l.a.createElement(D.b,{to:"/users/".concat(r)},l.a.createElement(L.a,{type:"primary"},"Go to profile page!"))):null),b.length?b.map((function(e){return l.a.createElement(Le.a,{title:e[0],key:e[0]},l.a.createElement(Le.a.Item,{label:"Grade"},je(e[1])),l.a.createElement(Le.a.Item,{label:"Progress Level"},e[2]))})):l.a.createElement("p",null,"No languages found."))};_t.defaultProps={isButtonPresent:!1};var Ht=j(_t),Gt=a(579),Yt=a(575),zt=a(49),Qt=a.n(zt),Vt=j((function(e){var t=e.store.userId,a=e.toUser,n=e.onSubmit,r=Object(c.useState)(!1),o=Object(p.a)(r,2),i=o[0],s=o[1],u=Object(c.useState)(""),d=Object(p.a)(u,2),m=d[0],g=d[1],f=function(){var e,r;m&&(s(!0),(e={content:m,receiverId:a,sourceId:t},_("comments",e,r)).then((function(e){s(!1),g(""),n()})))};return l.a.createElement(B.a.Search,{placeholder:"Your comment...",onSearch:f,size:"large",enterButton:"Comment",loading:i,onChange:function(e){g(e.target.value)},onPressEnter:f,value:m})})),Xt=j((function(e){var t=e.store.userId,a=e.ofUser,n=Object(c.useState)([]),r=Object(p.a)(n,2),o=r[0],i=r[1],s=function(){var e,t;(e={userId:a},W("comments/getCommentsByReceiverId",e,t)).then((function(e){var t=(e.data||[]).data;i((void 0===t?[]:t).map((function(e){return{author:l.a.createElement("a",{href:"/users/".concat(e.comment.sourceId)},e.sourceFirstName," ",e.sourceLastName),avatar:l.a.createElement(Bt.a,{src:Wt(e.comment.sourceId,32),alt:"avatar",size:32}),content:e.comment.content,datetime:Qt()(e.comment.createdAt).fromNow(),id:e.comment.id}})))}))};Object(c.useEffect)((function(){s()}),[t]);return l.a.createElement(F.a,{title:"Comments",style:{maxWidth:740,width:"calc(90% - 40px)",margin:10}},l.a.createElement(Gt.a,{className:"comment-list",header:"".concat(o.length," comments"),itemLayout:"horizontal",dataSource:o,renderItem:function(e){return l.a.createElement("li",{key:e.id},l.a.createElement(Yt.a,e))}}),l.a.createElement(Yt.a,{avatar:l.a.createElement(Bt.a,{src:Wt(t,32),size:32,alt:"avatar"}),content:l.a.createElement(Vt,{toUser:a,onSubmit:function(){s()}})}))})),Jt=j((function(e){var t=e.store.userId,a=e.otherUserId,n=Object(c.useState)(0),r=Object(p.a)(n,2),o=r[0],i=r[1],s=Object(c.useState)(!0),u=Object(p.a)(s,2),d=u[0],m=u[1];Object(c.useEffect)((function(){var e,n;m(!0),(e={receiverId:a,senderId:t},W("ratings/fromAtoB",e,n)).then((function(e){var t=(e.data||{}).data;i(void 0===t?{}:t),m(!1)})).catch()}),[t]);return l.a.createElement(Lt.a,{value:o,onChange:function(e){var n,r;m(!0),0===o?(n={receiverId:a,senderId:t,rating:e},_("ratings",n,r)).then((function(e){var t=(e.data||{}).data;i(void 0===t?{}:t),m(!1)})):function(e,t){return _("ratings/update",e,t)}({receiverId:a,senderId:t,rating:e}).then((function(e){var t=(e.data||{}).data;i(void 0===t?{}:t),m(!1)}))},disabled:d})})),Kt={layout:{height:"100%",alignItems:"center",overflow:"auto",padding:16},card:{maxWidth:740,width:"calc(90% - 40px)",margin:10}},$t=j((function(e){var t=e.store,a=Object(q.i)(),n=a.userId,r=t.userId;n&&(r=n);var o=Object(c.useState)(),i=Object(p.a)(o,2),s=i[0],u=i[1],d=function(){H(r).then((function(e){var t=(e.data||{}).data;u(void 0===t?{}:t)})).catch(console.log)};Object(c.useEffect)((function(){r&&d()}),[r]);return l.a.createElement(z.a,{style:Kt.layout},l.a.createElement(F.a,{title:"Profile Page",style:Kt.card},l.a.createElement(de.a,{loading:!s,title:!0,active:!0},l.a.createElement(Ht,s))),t.userId!==a.userId?l.a.createElement(F.a,{style:Kt.card},s?l.a.createElement("span",null,"Rate this user: ",l.a.createElement("br",null)," ",l.a.createElement(Jt,{otherUserId:n,onSubmit:function(){d()}})):null):null,l.a.createElement(Xt,{ofUser:n}))})),Zt=at.a.Option,ea=R.a.create({name:"inline_login"})((function(e){var t=e.onSubmit,a=e.form,n=a.getFieldDecorator;a.getFieldsError,a.getFieldError,a.isFieldTouched;return l.a.createElement(R.a,{layout:"inline",onSubmit:function(e){e.preventDefault(),a.validateFields((function(e,a){e||t(a)}))}},l.a.createElement(R.a.Item,null,n("firstName",{initialValue:""})(l.a.createElement(B.a,{placeholder:"All First Names",label:"First Name"}))),l.a.createElement(R.a.Item,null,n("lastName",{initialValue:""})(l.a.createElement(B.a,{placeholder:"All Last Names",label:"Last Name"}))),l.a.createElement(R.a.Item,null,n("grade",{initialValue:0})(l.a.createElement(at.a,{title:"Grade",style:{width:120}},l.a.createElement(Zt,{value:0},"All Grades"),l.a.createElement(Zt,{value:1},"A1"),l.a.createElement(Zt,{value:2},"A2"),l.a.createElement(Zt,{value:3},"B1"),l.a.createElement(Zt,{value:4},"B2"),l.a.createElement(Zt,{value:5},"C1"),l.a.createElement(Zt,{value:6},"C2")))),l.a.createElement(R.a.Item,null,n("languageId",{initialValue:""})(l.a.createElement(at.a,{label:"Language",style:{width:160}},l.a.createElement(Zt,{value:""},"All Languages"),l.a.createElement(Zt,{value:"1"},"English"),l.a.createElement(Zt,{value:"2"},"Turkish"),l.a.createElement(Zt,{value:"3"},"Italian")))),l.a.createElement(L.a,{type:"primary",htmlType:"submit"},"Search"))})),ta={card:{padding:20,margin:20,height:"calc(100% - 40px)"},innerCard:{overflow:"auto",maxHeight:"100%"}},aa=j((function(){var e=Object(c.useState)([]),t=Object(p.a)(e,2),a=t[0],n=t[1];return l.a.createElement(F.a,{style:ta.card,bodyStyle:ta.innerCard},l.a.createElement(ea,{onSubmit:function(e){var t,a;console.log(e),(t=e,_("search/users",t,a)).then((function(e){var t=(e.data||[]).data;n(void 0===t?[]:t)})).catch(console.log)}}),a.map((function(e){return l.a.createElement(F.a,{key:e.userId},l.a.createElement(Ht,Object.assign({},e,{isButtonPresent:!0})))})))})),na=a(117),ra=(a(241),a(101)),oa=j((function(e){var t=e.store.userId,a=e.otherUserId,n=Object(c.useState)([]),r=Object(p.a)(n,2),o=r[0],i=r[1],s=function(e){var a=(e.data||{}).data;i((void 0===a?{}:a).map((function(e){return{id:e.id,position:e.sourceId===t?"right":"left",type:"text",text:e.content,dateString:Qt()(e.createdAt).fromNow()}}))),new Promise((function(e,t){ra.Events.scrollEvent.register("end",(function(){e(),ra.Events.scrollEvent.remove("end")})),ra.scroller.scrollTo("contentScrollable",{duration:800,delay:0,smooth:"easeInOutQuart"})})).then((function(){ra.scroller.scrollTo("scroll-to-bottom",{duration:1500,delay:100,smooth:!0,containerId:"contentScrollable",offset:50})}))};Object(c.useEffect)((function(){var e,n;a&&(e={userId1:t,userId2:a},W("messages/chat",e,n)).then((function(e){s(e)})).catch(console.log)}),[a,t]);var u=Object(c.createRef)(),d=Object(c.useState)(""),m=Object(p.a)(d,2),g=m[0],f=m[1],h=Object(c.useState)(!1),b=Object(p.a)(h,2),y=b[0],v=b[1];return l.a.createElement(z.a,{style:{height:"100%"}},a&&l.a.createElement(l.a.Fragment,null,l.a.createElement(z.a.Content,{id:"contentScrollable",style:{overflow:"auto",position:"relative"}},l.a.createElement(na.MessageList,{className:"message-list",lockable:!0,toBottomHeight:"100%",dataSource:o}),l.a.createElement(ra.Element,{id:"scroll-to-bottom"})),l.a.createElement(z.a.Footer,null,l.a.createElement("form",{onSubmit:function(e){var n,r;e.preventDefault(),""===g||y||(v(!0),u.current&&u.current.clear(),(n={content:g,receiverId:a,sourceId:t},_("messages",n,r)).then(s).then((function(){v(!1),f("")})).catch((function(e){v(!1),u.current&&u.current.onChange({target:{value:g}}),console.log("error",e)})))}},l.a.createElement(na.Input,{ref:function(e){e&&(u.current=e)},autofocus:"true",onChange:function(e){f(e.target.value)},placeholder:"Type here...",rightButtons:l.a.createElement(L.a,{disabled:y,type:"primary",htmlType:"submit"},"Send")})))))})),ia=a(278),ca={card:{padding:20,margin:20}},la=j((function(e){var t=e.store.userId,a=Object(c.useState)(null),n=Object(p.a)(a,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){var e,a;t&&(e={userId:t},W("invitations/byReceiverId",e,a)).then((function(e){var t=(e.data||{}).data;o(void 0===t?[]:t)})).catch(console.log)}),[t]),l.a.createElement("div",{style:{height:"100%",display:"grid"}},Array.isArray(r)?r.length>0?l.a.createElement("ul",null,r.map((function(e){return l.a.createElement(F.a,{key:e.userId,style:ca.card},l.a.createElement(Ht,Object.assign({},e,{isButtonPresent:!0})))}))):l.a.createElement(F.a,{style:{margin:"auto"}},l.a.createElement("div",{style:{fontSize:18}},l.a.createElement("div",null,"No new chat invitations!"))):l.a.createElement(ia.a,{size:"large",style:{margin:"auto"}}))})),sa=z.a.Sider,ua=z.a.Content,da=function(e){var t=e.onClick;return l.a.createElement("div",{style:{width:"100%",height:72,paddingTop:10,paddingBottom:10,paddingRight:20,paddingLeft:20}},l.a.createElement(L.a,{onClick:t,type:"primary",shape:"round",style:{height:"100%",width:"100%",backgroundColor:i.appColorDark}},"View Pendings!"))},ma=j((function(e){var t=e.store.userId,a=Object(c.useState)(),n=Object(p.a)(a,2),r=n[0],o=n[1],i=Object(c.useState)([]),s=Object(p.a)(i,2),u=s[0],d=s[1];Object(c.useEffect)((function(){t&&function(e,t){return W("conversations",{id:e},t)}(t).then((function(e){var t=(e.data||{}).data;d((void 0===t?{}:t).map((function(e){return{avatar:"https://api.adorable.io/avatars/".concat(40,"/").concat(e.userId),title:"".concat(e.firstName," ").concat(e.lastName),userId:e.userId}})))})).catch(console.log)}),[t]);return l.a.createElement(z.a,{style:{height:"100%"}},l.a.createElement(sa,{width:300,collapsedWidth:72,style:{overflow:"auto"},theme:"light",collapsible:!0},l.a.createElement(da,{onClick:function(){o(null)}}),l.a.createElement(na.ChatList,{className:"no-horizontal-scroll",dataSource:u,onClick:function(e){var t=e.userId;return o(t)}})),l.a.createElement(ua,{style:{}},r?l.a.createElement(oa,{otherUserId:r}):l.a.createElement(la,null)))})),ga=(z.a.Header,z.a.Footer,z.a.Sider),fa=(z.a.Content,{sider:{background:"#fff",height:"100%"}}),pa=function(e){var t=e.essays,a=e.onClick;return l.a.createElement(ga,{width:400,style:fa.sider},l.a.createElement(Me.a,{onClick:a},t.map((function(e){return l.a.createElement(Me.a.Item,{key:e.key},e.text)}))))},ha=a(583),ba=j((function(e){var t=e.store,a=e.userId,n=e.firstName,r=(e.grade,e.lastName),o=(e.progressLevel,e.rating),i=e.essayId,s=Object(c.useState)(!1),u=Object(p.a)(s,2),d=u[0],m=u[1],g=Object(c.useState)(!1),f=Object(p.a)(g,2),h=f[0],b=f[1];return l.a.createElement(Gt.a.Item,null,l.a.createElement(Le.a,{title:"Recommendations",bordered:!0,column:1},l.a.createElement(Le.a.Item,{label:"Name"},n," ",r),l.a.createElement(Le.a.Item,{label:"Rating"},l.a.createElement(Lt.a,{allowHalf:!0,disabled:!0,defaultValue:Math.round(2*o)/2}))),l.a.createElement(L.a,{onClick:function(){var e,n;b(!0),(e={sourceId:t.userId,receiverId:a,essayId:i},_("requests",e,n)).then((function(e){m(!0),b(!1)}))},disabled:d,loading:h},d?"Request has been sent":"Send Request for Review"))}));function ya(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var va=j((function(e){var t=e.store.userId,a=e.visible,n=e.onOk,r=e.languageId,o=e.onCancel,i=e.essayId,s=Object(c.useState)(),u=Object(p.a)(s,2),m=u[0],g=u[1],f=Object(c.useState)(),h=Object(p.a)(f,2),b=h[0],y=h[1],v=Object(c.useState)([]),E=Object(p.a)(v,2),O=E[0],j=E[1];return Object(c.useEffect)((function(){H(t).then((function(e){var t=(e.data||{}).data,a=void 0===t?{}:t;0===Object.entries(a).length&&a.constructor!==Object||g(a)}))}),[t]),Object(c.useEffect)((function(){m&&m.hasOwnProperty("grades")&&Array.isArray(m.grades)&&m.hasOwnProperty("languages")&&Array.isArray(m.languages)&&m.grades.length===m.languages.length?y(m.languages.reduce((function(e,t,a){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ya(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ya(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,Object(d.a)({},t,m.grades[a]))}),{})):console.log("no grade")}),[m]),Object(c.useEffect)((function(){if(b){var e=b[Ne(r)];(t={grade:e,languageId:r},_("recommendations",t,a)).then((function(e){var t=(e.data||[]).data;j(void 0===t?[]:t)})).catch(console.log)}var t,a}),[b]),l.a.createElement(ha.a,{visible:a,onOk:n,width:600,onCancel:o},O?l.a.createElement(Gt.a,null,O.map((function(e){return l.a.createElement(ba,Object.assign({},e,{key:e.userId,essayId:i}))}))):l.a.createElement(ia.a,{size:"large"}))})),Ea=a(284),Oa=a(99);function ja(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var wa=function(){function e(){var t=this;if(Object(P.a)(this,e),this.id=void 0,this.userId=void 0,this.userName="",this.userEmail="",this.body="",this.motivation="commenting",this.targetUrl="",this.targetType="",this.setIdFromLink=function(e){t.id=(/(\d+)$/.exec(e)||[])[1]},this.setModified=function(){t.modifiedAt=new Date},this.setTarget=function(e){t.targetUrl=e},this.setUser=function(e){var a=e.email,n=e.firstName,r=e.lastName,o=e.userId;t.userId=o,t.userName="".concat(n," ").concat(r),t.userEmail=a},this.setMessage=function(e){t.body=e,t.modifiedAt=new Date},this.setMotivation=function(e){t.motivation=e,t.modifiedAt=new Date},this.setAnnotationId=function(e){t.id=e},this.createdAt=new Date,this.modifiedAt=this.createdAt,this.constructor===e)throw new Error("Do not use AnnotationData class directly it is abstract")}return Object(x.a)(e,[{key:"toDataModel",value:function(){var e={"@context":"http://www.w3.org/ns/anno.jsonld"};return this.id&&(e.id="https://api.bounswe2019group9.tk/annotations?id=".concat(this.id)),e.type="Annotation",e.creator={id:"https://bounswe2019group9.tk/users/".concat(this.userId),type:"Person",name:this.userName,email:this.userEmail},e.created=this.createdAt.toISOString(),e.modified=this.modifiedAt.toISOString(),e.body={type:"TextualBody",value:this.body,format:"text/plain"},e.motivation=this.motivation,e.target={},e}},{key:"clone",value:function(){var e=new this.constructor;return e.id=this.id,e.userId=this.userId,e.userName=this.userName,e.userEmail=this.userEmail,e.body=this.body,e.motivation=this.motivation,e.targetUrl=this.targetUrl,e.targetType=this.targetType,e.createdAt=this.createdAt,e.modifiedAt=this.modifiedAt,e}},{key:"motivationObject",get:function(){return e.motivationTypeToMotivationObject(this.motivation)}},{key:"displayTitle",get:function(){return"".concat(this.body)}},{key:"displayBody",get:function(){var e='"'.concat(this.motivationObject.label||"New",'" ~ ').concat(this.userName," ~ ").concat(this.userEmail," \n\n created ").concat(Qt()(this.createdAt).fromNow());return this.modifiedAt!=this.createdAt&&(e+=", edited on ".concat(Qt()(this.modifiedAt).fromNow())),e}}]),e}();wa.motivationTypes=[{value:"assessing",label:"Assessing"},{value:"bookmarking",label:"Bookmarking"},{value:"classifying",label:"Classifying"},{value:"commenting",label:"Commenting"},{value:"describing",label:"Describing"},{value:"editing",label:"Editing"},{value:"highlighting",label:"Highlighting"},{value:"identifying",label:"Identifying"},{value:"linking",label:"Linking"},{value:"moderating",label:"Moderating"},{value:"questioning",label:"Questioning"},{value:"replying",label:"Replying"},{value:"tagging",label:"Tagging"}],wa.motivationTypeToMotivationObject=function(){var e=wa.motivationTypes.reduce((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ja(a,!0).forEach((function(t){Object(d.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ja(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,Object(d.a)({},t.value,t))}),{});return function(t){return e[t]||{}}}();var Ia=wa,Sa=function(e){function t(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=a.displayX,r=void 0===n?60:n,o=a.displayY,i=void 0===o?30:o;return Object(P.a)(this,t),(e=Object(C.a)(this,Object(T.a)(t).call(this))).originalX=0,e.originalY=0,e.originalWidth=1,e.originalHeight=1,e.targetType="image",e.displayX=r,e.displayY=i,e.displayWidth=60,e.displayHeight=30,e}return Object(A.a)(t,e),Object(x.a)(t,[{key:"toDataModel",value:function(){var e=Object(Oa.a)(Object(T.a)(t.prototype),"toDataModel",this).call(this);e.target.id=this.targetUrl,e.target.type="Image";var a=this.targetUrl.substr(this.targetUrl.lastIndexOf(".")+1).toLowerCase();return a=a.startsWith("jpeg")||a.startsWith("jpg")?"jpeg":a.startsWith("png")?"png":"*",e.target.format="image/".concat(a),e.target.selector={type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:"xywh=".concat(this.originalX,",").concat(this.originalY,",").concat(this.originalWidth,",").concat(this.originalHeight)},e}},{key:"clone",value:function(){var e=Object(Oa.a)(Object(T.a)(t.prototype),"clone",this).call(this);return e.originalX=this.originalX,e.originalY=this.originalY,e.originalWidth=this.originalWidth,e.originalHeight=this.originalHeight,e}},{key:"displayX",get:function(){return this.originalX*t.realWidth/t.naturalWidth},set:function(e){this.originalX=Math.round(e*t.naturalWidth/t.realWidth)}},{key:"displayY",get:function(){return this.originalY*t.realHeight/t.naturalHeight},set:function(e){this.originalY=Math.round(e*t.naturalHeight/t.realHeight)}},{key:"displayWidth",get:function(){return this.originalWidth*t.realWidth/t.naturalWidth},set:function(e){this.originalWidth=Math.round(e*t.naturalWidth/t.realWidth)}},{key:"displayHeight",get:function(){return this.originalHeight*t.realHeight/t.naturalHeight},set:function(e){this.originalHeight=Math.round(e*t.naturalHeight/t.realHeight)}}]),t}(Ia);Sa.naturalWidth=1,Sa.naturalHeight=1,Sa.realWidth=1,Sa.realHeight=1;var ka=function(e){function t(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=a.start,r=void 0===n?0:n,o=a.end,i=void 0===o?0:o;return Object(P.a)(this,t),(e=Object(C.a)(this,Object(T.a)(t).call(this))).targetType="text",e.start=r,e.end=i,e}return Object(A.a)(t,e),Object(x.a)(t,[{key:"toDataModel",value:function(){var e=Object(Oa.a)(Object(T.a)(t.prototype),"toDataModel",this).call(this);return e.target.id=this.targetUrl,e.target.type="Text",e.target.format="text/plain",e.target.selector={type:"FragmentSelector",conformsTo:"http://tools.ietf.org/rfc/rfc5147",value:"char=".concat(this.start,",").concat(this.end)},e}},{key:"clone",value:function(){var e=Object(Oa.a)(Object(T.a)(t.prototype),"clone",this).call(this);return e.start=this.start,e.end=this.end,e}}]),t}(Ia),Pa=function e(){Object(P.a)(this,e)},xa=Pa,Ca=(Pa.fromDataModel=function(e){var t;if("Image"===e.target.type){t=new Sa;var a=e.target.selector.value.substr(5).split(","),n=Object(p.a)(a,4),r=n[0],o=n[1],i=n[2],c=n[3];t.originalX=parseInt(r,10),t.originalY=parseInt(o,10),t.originalWidth=parseInt(i,10),t.originalHeight=parseInt(c,10)}else{if("Text"!==e.target.type)throw new Error('Unknown annotation target type, must be "Image" or "Text"');t=new ka;var l=e.target.selector.value.substr(5).split(","),s=Object(p.a)(l,2),u=s[0],d=s[1];t.start=parseInt(u,10),t.end=parseInt(d,10)}return t.id=(/(\d+)$/.exec(e.id)||[])[1],t.userId=parseInt((/(\d+)$/.exec(e.creator.id)||[])[1],10),t.userName=e.creator.name,t.userEmail=e.creator.email,t.createdAt=new Date(e.created),t.modifiedAt=new Date(e.modified),t.body=e.body.value,t.motivation=e.motivation,t.targetUrl=e.target.id,t},a(55)),Ta=function(e){var t=e.annotation,a=e.isOwner,n=e.onSaveAnnotation,r=e.setEditingAnnotation,o=Object(c.useState)({}),i=Object(p.a)(o,2),s=i[0],u=i[1],d=Object(c.useState)(!1),m=Object(p.a)(d,2),g=m[0],f=m[1],h=t.displayTitle,b=t.displayBody,y=t.displayX,v=t.displayY,E=-t.displayWidth,O=-t.displayHeight;return l.a.createElement(Ca.EditableAnnotation,Object.assign({x:y-E,y:v-O,dx:40,dy:20-O/2,color:"#9610ff",className:"show-bg no-select clickable",events:{onClick:function(){a&&!g&&r(t)}},onDragStart:function(){f(!0)},onDragEnd:function(e){if(setTimeout((function(){f(!1)}),10),[e.x-(y-E),e.y-(v-O),e.width-E,e.height-O].map((function(e){return Math.abs(e)})).reduce((function(e,t){return e+t}))>.1){t.displayX=e.x+e.width,t.displayY=e.y+e.height,t.displayWidth=-e.width,t.displayHeight=-e.height;var a=t.clone();a.setModified(),n(t,a)}u({dx:e.dx,dy:e.dy})},width:E,height:O},s),l.a.createElement(Ca.SubjectRect,{fill:"ddddff",fillOpacity:.4,editMode:a}),l.a.createElement(Ca.ConnectorElbow,null,l.a.createElement(Ca.ConnectorEndDot,null)),l.a.createElement(Ca.Note,{align:"middle",orientation:"topBottom",bgPadding:20,wrap:240,padding:15,titleColor:"rgb(12, 54, 11)",labelColor:"#1690ff",lineType:"vertical",title:h,label:b}))},Aa={container:{position:"relative"},image:{maxWidth:"100%"},annotationContainer:{position:"absolute",overflow:"visible",top:0,left:0,zIndex:100}},Da=Object(Ea.a)("bounds")((function(e){var t=e.measureRef,a=e.contentRect,n=e.source,r=e.annotations,o=e.dispatch,i=e.user,s=e.onSaveAnnotation,u=e.setEditingAnnotation,d=a.bounds,m=d.width,g=d.height,f=d.left,h=d.top;Sa.realWidth=m,Sa.realHeight=g;var b=Object(c.useState)(!1),y=Object(p.a)(b,2),v=y[0],E=y[1];return l.a.createElement("div",{ref:t,style:Aa.container},l.a.createElement("img",{src:n,ref:function(e){if(e){e.addEventListener("load",(function t(){Sa.naturalWidth=e.naturalWidth||m,Sa.naturalHeight=e.naturalHeight||g,e.removeEventListener("load",t),E(!0),console.log("hulog")}))}},title:"Essay",alt:"Essay",onClick:function(e){var t=e.clientX,a=e.clientY,c=new Sa({displayX:t-f,displayY:a-h});c.setUser(i),c.setTarget(n),o({type:"newAnnotation",data:[].concat(Object(Ge.a)(r),[c])})}}),v?l.a.createElement("svg",{style:Aa.annotationContainer,width:1,height:1},r.map((function(e,t){return l.a.createElement(Ta,{key:e.id||"anno_".concat(t),annotation:e,isOwner:e.userId===i.userId,onSaveAnnotation:s,setEditingAnnotation:u})}))):null)})),qa=a(282),Fa={container:{position:"relative"},svg:{position:"absolute",overflow:"visible",zIndex:100}},Na=j((function(e){var t=e.store.userId,a=e.annotation,n=e.setEditingAnnotation,r=Object(c.useState)({}),o=Object(p.a)(r,2),i=o[0],s=o[1],u=Object(c.useState)(!1),d=Object(p.a)(u,2),m=d[0],g=d[1],f=t===a.userId,h=a.displayTitle,b=a.displayBody;return l.a.createElement("span",{style:Fa.container},l.a.createElement("svg",{style:Fa.svg,width:1,height:1},l.a.createElement(Ca.EditableAnnotation,Object.assign({x:0,y:10,dx:70,dy:40,color:"#9610ff",className:"show-bg no-select clickable",events:{onClick:function(e,t,r){f&&!m&&n(a)},onMouseUp:function(e,t,a){a.stopPropagation()}},onDragStart:function(){g(!0)},onDragEnd:function(e){setTimeout((function(){g(!1)}),10),s({dx:e.dx,dy:e.dy})}},i),l.a.createElement(Ca.ConnectorElbow,null,l.a.createElement(Ca.ConnectorEndDot,null)),l.a.createElement(Ca.Note,{align:"middle",orientation:"topBottom",bgPadding:20,wrap:240,padding:15,titleColor:"rgb(12, 54, 11)",labelColor:"#1690ff",lineType:"vertical",title:h,label:b},l.a.createElement("text",null,"hello")))))})),Ra={container:{margin:32,padding:16,backgroundColor:"#fff",border:"1px solid #000"}},Ba=function(e){var t=e.source,a=e.annotations,n=e.dispatch,r=e.user,o=e.targetUrl,i=e.setEditingAnnotation,c=function(e){n({type:"removeAnnotation",data:e})};return l.a.createElement("div",{style:Ra.container},l.a.createElement(qa.TextAnnotator,{style:{lineHeight:1.5},content:t,value:a,onChange:function(e){e.length>a.length&&n({type:"newAnnotation",data:e})},getSpan:function(e){var t=e.start,a=e.end,n=new ka({start:t,end:a});return n.setUser(r),n.setTarget(o),n.tag=l.a.createElement(Na,{annotation:n,onRemoveAnnotation:c,setEditingAnnotation:i}),n}}))},La=a(576),Ua=R.a.create({name:"annotation_form"})((function(e){var t=e.annotation,a=e.form,n=e.setEditingAnnotation,r=e.onSaveAnnotation,o=e.onRemoveAnnotation,i=Object(c.useReducer)((function(e,t){switch(t.type){case"reinitialize":return{message:t.data.body,motivation:t.data.motivation,loading:!1};case"loading":return{loading:!0};case"loaded":return{loading:!1};default:return e}}),{message:"",motivation:Ia.motivationTypes[0],loading:!1}),s=Object(p.a)(i,2),u=s[0],d=s[1];Object(c.useEffect)((function(){t&&(d({type:"reinitialize",data:t}),a.resetFields())}),[t]);var m=function(e){e.preventDefault(),a.validateFields((function(e,a){if(!e){var n=a.message,o=a.motivation,i=t.clone();i.setMessage(n),i.setMotivation(o),d({type:"loading"}),r(t,i).finally((function(){d({type:"loaded"})}))}}))},g=function(e){e.preventDefault(),u.loading||(t.id?n(null):o(t))};return l.a.createElement(ha.a,{title:"Annotate Essay",visible:!!t,onOk:m,onCancel:g,footer:[l.a.createElement(La.a,{key:"delete",title:"Are you sure you want to delete this annotation\uff1f",icon:l.a.createElement(J.a,{type:"question-circle-o",style:{color:"red"}}),onConfirm:function(e){e.preventDefault(),o(t)}},l.a.createElement(L.a,{type:"danger",disabled:u.loading},"Delete"),","),l.a.createElement(L.a,{key:"back",onClick:g,disabled:u.loading},"Close"),l.a.createElement(L.a,{key:"submit",onClick:m,type:"primary",loading:u.loading},"Save")]},l.a.createElement(R.a,{layout:"vertical",onSubmit:m},l.a.createElement(R.a.Item,{label:"Motivation"},a.getFieldDecorator("motivation",{initialValue:u.motivation,rules:[{required:!0,message:"Please select a motivation"}]})(l.a.createElement(at.a,null,Ia.motivationTypes.map((function(e){var t=e.label,a=e.value;return l.a.createElement(at.a.Option,{value:a,key:a},t)}))))),l.a.createElement(R.a.Item,{label:"Message"},a.getFieldDecorator("message",{initialValue:u.message,rules:[{required:!0,message:"Please enter a message"}]})(l.a.createElement(B.a.TextArea,{placeholder:"Enter your message",autoSize:{minRows:2,maxRows:6}})))))})),Ma=(a(569),{container:{minWidth:300}}),Wa=j((function(e){var t=e.essay,a=e.store.userId,n=Object(c.useState)(),r=Object(p.a)(n,2),o=r[0],i=r[1];Object(c.useEffect)((function(){console.log("userId",a),a&&H(a).then((function(e){var t=(e.data||{}).data;i(void 0===t?{}:t)})).catch(console.log)}),[a]);var s=t.id,u=(t.assignmentId,t.authorId,t.sourceType),d=t.source,m=2===u?d:"https://api.bounswe2019group9.tk/essays/getSourceByEssayId?id=".concat(s),g=Object(c.useState)(null),f=Object(p.a)(g,2),h=f[0],b=f[1],y=Object(c.useReducer)((function(e,t){switch(t.type){case"initialize":return t.data;case"newAnnotation":return b(t.data[t.data.length-1]),t.data;case"removeAnnotation":return h===t.data&&b(null),e.filter((function(e){return e!==t.data}));case"updateAnnotation":return h===t.data.annotation&&b(null),e.map((function(e){return e===t.data.annotation?t.data.nextAnnotation:e}));default:return e}}),[]),v=Object(p.a)(y,2),E=v[0],O=v[1];Object(c.useEffect)((function(){var e,t;m&&(e=m,W("annotations/searchInAnnotations",{targetId:e},t)).then((function(e){var t=(e.data||{}).data,a=((void 0===t?[]:t)||[]).map((function(e){return JSON.parse(e)})).map(xa.fromDataModel);1===u&&(a=a.map((function(e){return e.tag=l.a.createElement(Na,{annotation:e,onRemoveAnnotation:w,setEditingAnnotation:b}),e}))),O({type:"initialize",data:a})})).catch(console.log)}),[m]);var j=function(e,t){var a,n=!e.id,r=t.toDataModel();return delete r.id,r=JSON.stringify(r),(n?_("annotations",{annotation:r},a):function(e,t){return _("annotations/update",e,t)}({id:e.id,annotation:r})).then((function(a){var n=a.data.data;n=JSON.parse(n),t.setIdFromLink(n.id),1===u&&(t.tag=l.a.createElement(Na,{annotation:t,onRemoveAnnotation:w,setEditingAnnotation:b})),O({type:"updateAnnotation",data:{annotation:e,nextAnnotation:t}})}))},w=function(e){var t,a;if(!e.id)return O({type:"removeAnnotation",data:e});(t=e.id,W("annotations/deleteById",{annotationId:t},a)).then((function(t){O({type:"removeAnnotation",data:e})})).catch(console.log)},I=2==u?Da:1==u?Ba:null;return l.a.createElement("div",{style:Ma.container},I&&l.a.createElement(I,{source:d,annotations:E,dispatch:O,user:o||{},targetUrl:m,onSaveAnnotation:j,setEditingAnnotation:b}),l.a.createElement(Ua,{annotation:h,setEditingAnnotation:b,onSaveAnnotation:j,onRemoveAnnotation:w}))})),_a=function(e){var t=e.essayId,a=Object(c.useState)(),n=Object(p.a)(a,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){t&&function(e,t){return W("essays",{id:e},t)}(t).then((function(e){var t=(e.data||{}).data;o(void 0===t?{}:t)})).catch(console.log)}),[t]),r?l.a.createElement(Wa,{essay:r}):null},Ha=(z.a.Header,z.a.Footer),Ga=(z.a.Sider,z.a.Content),Ya={content:{display:"flex",alignItems:"center",flexDirection:"column",overflow:"auto"},footer:{width:"100%",display:"grid",justifyContent:"center",alignContent:"center"}},za=j((function(e){var t=e.store.userId,a=Object(c.useState)([]),n=Object(p.a)(a,2),r=n[0],o=n[1],i=Object(c.useState)(null),s=Object(p.a)(i,2),u=s[0],d=s[1],m=Object(c.useState)(!1),g=Object(p.a)(m,2),f=g[0],h=g[1],b=Object(c.useState)(),y=Object(p.a)(b,2),v=y[0],E=y[1],O=function(){var e,a;(e={id:t},W("essays/user",e,a)).then((function(e){var t=(e.data||[]).data;o(void 0===t?[]:t)})).catch(console.log)};Object(c.useEffect)((function(){O()}),[t]);var j=r.map((function(e){return{key:e.essay.id,text:e.assignment.question}}));return Object(c.useEffect)((function(){var e=!0,t=!1,a=void 0;try{for(var n,o=r[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var i=n.value;i.essay.id===u&&E(i.assignment.languageId)}}catch(c){t=!0,a=c}finally{try{e||null==o.return||o.return()}finally{if(t)throw a}}}),[u]),l.a.createElement(z.a,{style:{height:"100%"}},l.a.createElement(pa,{essays:j,onClick:function(e){var t=e.key;d(t)}}),l.a.createElement(z.a,null,l.a.createElement(Ga,{style:Ya.content},l.a.createElement(_a,{essayId:u})),l.a.createElement(Ha,{style:Ya.footer},l.a.createElement(L.a,{onClick:function(){return h(!0)}},"Request Review"),l.a.createElement(va,{essayId:u,visible:f,languageId:v,onCancel:function(){return h(!1)}}))))})),Qa=(z.a.Header,z.a.Footer,z.a.Sider,z.a.Content),Va={content:{display:"flex",alignItems:"center",flexDirection:"column",overflow:"auto"},footer:{width:"100%",display:"grid",justifyContent:"center",alignContent:"center"}},Xa=j((function(e){var t=e.store.userId,a=Object(c.useState)([]),n=Object(p.a)(a,2),r=n[0],o=n[1],i=Object(c.useState)(null),s=Object(p.a)(i,2),u=s[0],d=s[1],m=function(){(function(e,t){return W("requests",{userId:e},t)})(t).then((function(e){var t=(e.data||{}).data;o(void 0===t?[]:t)})).catch(console.log)};Object(c.useEffect)((function(){m()}),[t]);var g=r.map((function(e){return{key:e.essayId,text:"".concat(e.question," (").concat(e.username,")")}}));return l.a.createElement(z.a,{style:{height:"100%"}},l.a.createElement(pa,{essays:g,onClick:function(e){var t=e.key;d(t)}}),l.a.createElement(z.a,null,l.a.createElement(Qa,{style:Va.content},l.a.createElement(_a,{essayId:u}))))})),Ja=function(e){function t(){return Object(P.a)(this,t),Object(C.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return l.a.createElement(z.a,{className:"layout"},l.a.createElement(z.a.Header,{style:Ka.header},l.a.createElement(Tt,null)),l.a.createElement(z.a.Content,null,l.a.createElement(q.d,null,l.a.createElement(q.a,{from:"/(login|register|forgot)",to:"/"}),l.a.createElement(q.b,{exact:!0,path:"/language-select",component:pe}),l.a.createElement(q.b,{exact:!0,path:"/sample",component:Rt}),l.a.createElement(q.b,{exact:!0,path:"/home",component:It}),l.a.createElement(q.b,{exact:!0,path:"/users",component:aa}),l.a.createElement(q.b,{exact:!0,path:"/users/:userId",component:$t}),l.a.createElement(q.b,{exact:!0,path:"/chat",component:ma}),l.a.createElement(q.b,{exact:!0,path:"/essays",component:za}),l.a.createElement(q.b,{exact:!0,path:"/reviews",component:Xa}),l.a.createElement(q.b,{path:"/:language",component:jt}),l.a.createElement(q.a,{to:"/home"}))))}}]),t}(l.a.PureComponent),Ka={header:{backgroundColor:i.appColorDark}},$a=Ja,Za=j(function(e){function t(){return Object(P.a)(this,t),Object(C.a)(this,Object(T.a)(t).apply(this,arguments))}return Object(A.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props.store.token;return l.a.createElement(D.a,null,e?l.a.createElement($a,null):l.a.createElement(ue,null))}}]),t}(l.a.PureComponent));var en=function(){return l.a.createElement(Za,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(l.a.createElement(en,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[286,1,2]]]);
//# sourceMappingURL=main.3e40644f.chunk.js.map